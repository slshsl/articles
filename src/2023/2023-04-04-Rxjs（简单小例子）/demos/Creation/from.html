<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
	</head>
	<body>
		<script src="./rxjs.js"></script>
		<script>
			const { from, Observable } = rxjs;

			// 接受一个可迭代对象
			from([1, 2, 3]).subscribe({
				next: (value) => console.log(value),
				complete: () => console.log('Complete')
			});

			// 接受一个promise
			from(Promise.resolve(1)).subscribe({
				next: (value) => console.log(value),
				complete: () => console.log('Complete')
			});

			// 自己实现的from
			const myFrom = function (iteratorableObj) {
				return new Observable((subscriber) => {
					if (
						typeof iteratorableObj === 'object' &&
						typeof iteratorableObj.then === 'function'
					) {
						iteratorableObj
							.then((val) => {
								subscriber.next(val);
							})
							.catch((err) => {
								subscriber.error(err);
							})
							.finally(() => {
								subscriber.complete();
							});
					} else {
						for (const iterator of iteratorableObj) {
							subscriber.next(iterator);
							subscriber.complete();
						}
					}
				});
			};

			myFrom([1, 2, 3]).subscribe({
				next: (value) => console.log(value),
				complete: () => console.log('Complete')
			});

			myFrom(Promise.resolve(1)).subscribe({
				next: (value) => console.log(value),
				complete: () => console.log('Complete')
			});
		</script>
	</body>
</html>
